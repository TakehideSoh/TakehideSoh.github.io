<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>プログラミング言語論および演習 (演習前半) <br>** 切符問題 **</title>
<!-- 2013-11-15 金 14:04 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Takehide Soh" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../myhome.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">プログラミング言語論および演習 (演習前半) <br>** 切符問題 **</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">切符問題とは?</a></li>
<li><a href="#sec-2">計算機で切符問題を解くためのアプローチ</a></li>
<li><a href="#sec-3">二分木の表現</a></li>
<li><a href="#sec-4">二分木が与えられた時にその値を計算する</a></li>
<li><a href="#sec-5">3つの整数の列からの二分木を洩れなく列挙する機能</a></li>
<li><a href="#sec-6">genTrees3 関数で遊ぶ</a></li>
<li><a href="#sec-7">課題</a></li>
<li><a href="#sec-8">チャレンジ課題</a></li>
</ul>
</div>
</div>
<style type="text/css">
#table1 th { font-weight:normal; text-align: center; background-color: #eeeeee; color: black; border: none}
#table1 td { background-color: #eeeeee; color: black; border: none}

#table2 th    { background-color: #3B5998; color: white; border-style:
#solid; border-color: black; border-width: thin; border: none;}
#table2 td    { background-color: #eeeeee; color: black; border-style: solid; border-color: black; border-width: thin; border: none}
#table2 td+td { background-color: #efefff; color: black;}
#table2 td    { text-align: center; background-color: #3B5998; color: white; width:120px}
#table2 td+td { text-align: center; width:120px; color: black;}
#table2 td+td+td { text-align: left; width:500px; color: black;}

#table3 th { font-weight:normal; text-align: left;  border: none; background-color: #f1f1f1}
#table3 td { border: none; background-color: #f1f1f1}

ws.pre.src {
  background: #ffffee;
  color: black;
}
</style>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">切符問題とは?</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">概要</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>普段あまり意識することはないが，切符には4つの整数が印字されている．
</li>
</ul>
<p>
 <div align="center"><img src="./ticket.png"></div>
</p>
<ul class="org-ul">
<li>この4つの数字 (上の例では"8115") に適切に括弧付けと四則演算をすることで結果をちょうど10にすることが出来るだろうか?
</li>
<li>また出来る場合にいくつの括弧付け四則演算の組合せが存在するだろうか?
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">切符問題</h3>
<div class="outline-text-3" id="text-1-2">
<p>
 <font color="#3B5998"><b>切符問題</b></font>を以下のように定義する．
</p>
<ul class="org-ul">
<li>(入力)
<ol class="org-ol">
<li> <font color="#3B5998"><b>4つの整数の列</b></font> &#x2013; 切符に印字された整数に対応 (上記の例では"8115")
</li>
<li> <font color="#3B5998"><b>目的整数</b></font> &#x2013; 結果を何の数字にするか (上記の例では10)
</li>
</ol>
</li>
<li>(出力)
<ul class="org-ul">
<li>与えられた整数列 (順序固定) に括弧付けおよび四則演算を行った式の中で演算結果が目的整数と一致するもの
<ul class="org-ul">
<li>但し，演算は3回行うものとする (つまり 81-15 とかはだめ)．
</li>
</ul>
</li>
</ul>
</li>
</ul>

<p>
以降，簡単のために誤解が無い場合には切符問題を ("8115", 10) などと対で標記する．
</p>

<ul class="org-ul">
<li>切符問題のバリエーションとして，整数列の順序を変更して良い問題も考えられる．
</li>
<li>この問題は「 <font color="#3B5998"><b>順序可変の切符問題</b></font>」と呼び以後区別する．
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">計算機で切符問題を解くためのアプローチ</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">切符問題と二分木</h3>
<div class="outline-text-3" id="text-2-1">
<p>
どうやって ("8115"，10) の切符問題を解けば良いだろうか？一つずつ試してみるのが一つの方法．
</p>
<ul class="org-ul">
<li>((8 + 1) - 1) - 5
</li>
<li>(8 + 1) - (1 - 5)
</li>
<li>&#x2026; 
</li>
</ul>

<p>
但し，手でやるのは大変．計算機を使おう．
ただ，上述のような括弧付けされた数式はどのようなデータ構造で表せるだろうか?  <font color="#3B5998"><b>二分木 (全二分木)</b></font> というデータ構造を使ってみる．
 <div align="center"><img src="./ex2.png" width=" 80%"></div>
うまく括弧付けされた数式を表すことができそう．よって，
</p>
<ul class="org-ul">
<li> <font color="#3B5998"><b>二分木の値を計算すること</b></font>
</li>
<li> <font color="#3B5998"><b>二分木を全て列挙すること</b></font>
</li>
</ul>
<p>
ができれば列挙したそれぞれの二分木の値が目的整数と一致するかを確認することで答えが見つかるだろう．
実際この方法によって("8115",10)の解(8 / (1 - (1 / 5)))が計算できる．
</p>


<p>
二分木について用語の説明を行う．
切符問題のための二分木を，葉ノードに整数が，内部ノードに演算子がラベル付けされたものとして表す．("8115",10)の解(8 / (1 - (1 / 5)))は二分木を使うと次のように表すことができる．
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left"> <div align="center"><img src="./ticket8115annotate1.png" width=" 95%"></div></td>
<td class="left"> <div align="center"><img src="./ticket8115annotate2.png" width=" 95%"></div></td>
</tr>
</tbody>
</table>
<ul class="org-ul">
<li>内部ノード (Inner Node) は必ず二つの子を持ち葉ノード (Leaf Node) は子を持たない．
</li>
<li>親を持たないノードは根ノード (Root Node) と呼ばれる．
</li>
<li>内部ノードの二つの子はそれぞれ左 (left) と 右 (right) と呼ばれる．
</li>
<li> <font color="#3B5998"><b>二分木はその各ノードを根ノードとする二分木から構成される再帰的な構造として捉えることができる．</b></font>
</li>
</ul>

<p>
このように括弧付けされた数式はは二分木によって表すことができる．
</p>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">切符問題解法プログラム</h3>
<div class="outline-text-3" id="text-2-2">
<p>
二分木を使って問題を解くためのプログラムには次が必要になる．
</p>
<ol class="org-ol">
<li>二分木の表現
</li>
<li>二分木が与えられた時にその値を計算する機能
</li>
<li>与えられた演算子と整数の列からの二分木を洩れなく列挙する機能
</li>
</ol>
<p>
これらの機能があれば二分木を列挙し一つ一つ評価することで解を見つけ，またその列挙を行うことができる．
</p>


<p>
 <font color="#3B5998"><b>以降，Scalaを使って切符問題解法プログラムを作る方法について説明する．</b></font>
</p>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">二分木の表現</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">クラスとオブジェクトの簡単な説明</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>プログラミング言語論の講義でオブジェクトとクラスについては説明される (<a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/java.html">URL</a>) 予定なので，ここでは簡単に説明する．
</li>
<li>オブジェクト指向プログラミングではなんらかの機能を持ったオブジェクトを組み合わせて新しい機能を持ったオブジェクトを構築し， 全体として一つのソフトウェア機械を実現する．
</li>
<li>しかし，同じ機能をもつ類似のオブジェクトを別々に定義するのは効率が悪い．
</li>
<li>Scala ではオブジェクトの型紙となる <font color="#a020f0">クラス</font>を定義し，それを用いてオブジェクトを生成する．
<ul class="org-ul">
<li>またさらに型紙の共通する性質をまとめて <font color="#a020f0">抽象クラス</font>を定義することもできる．
</li>
<li>以下では，クラスでも特に様々な機能を備える <font color="#a020f0">ケースクラス</font>を使う (ケースクラスの詳細は<a href="http://www.ne.jp/asahi/hishidama/home/tech/scala/class.html#h_case_class">ここ</a>)．
</li>
<li>Scala におけるクラスとオブジェクトについてもっと知りたい人は <a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/scala.html">ここ</a> に記述された参考資料・書籍を使って学習してください．
</li>
</ul>
</li>
<li>クラスの定義を型紙として，型紙から生成された具体例 (インスタンス) が個々のオブジェクトとなる．
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Scalaにおける二分木の表現</h3>
<div class="outline-text-3" id="text-3-2">
<p>
3つのクラスによって二分木を表現する．抽象クラス <font color="#228b22">Tree</font>を <font color="#228b22">Leaf</font>と <font color="#228b22">Node</font>クラスが継承するようにする．
Scala のプログラムは以下のようになる．
</p>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">abstract</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Tree</span>
<span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Leaf</span>(<span style="color: #a0522d;">n</span>: <span style="color: #228b22;">Int</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span>
<span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Node</span>(<span style="color: #a0522d;">op</span>: <span style="color: #228b22;">String</span>, <span style="color: #a0522d;">left</span>: <span style="color: #228b22;">Tree</span>, <span style="color: #a0522d;">right</span>: <span style="color: #228b22;">Tree</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span>
</pre>
</div>

<ul class="org-ul">
<li> <font color="#a020f0">抽象クラス</font>  <font color="#228b22">Tree</font>
<ul class="org-ul">
<li>二分木の共通な機能・性質を表す．抽象クラスなのでオブジェクトは生成できない．
</li>
</ul>
</li>
<li> <font color="#a020f0">ケースクラス</font>  <font color="#228b22">Leaf</font>
<ul class="org-ul">
<li>葉ノードを根ノードとする二分木を表す．
</li>
<li> <font color="#228b22">Int</font>型  <font color="#a0522d">n</font>. 葉ノードに入っている整数値を表す．
</li>
</ul>
</li>
<li> <font color="#a020f0">ケースクラス</font>  <font color="#228b22">Node</font>
<ul class="org-ul">
<li>内部ノードを根ノードとする二分木を表す．
</li>
<li> <font color="#228b22">String</font>型  <font color="#a0522d">op</font>. 内部ノードに入っている演算子を表す．
</li>
<li> <font color="#228b22">Tree</font>型  <font color="#a0522d">left</font>. 左の二分木を表す．
</li>
<li> <font color="#228b22">Tree</font>型  <font color="#a0522d">right</font>. 右の二分木を表す．
</li>
</ul>
</li>

<li>上記クラスの関係を図示すると次のようになる．
</li>
</ul>
<p>
 <div align="center"><img src="./ticket-tree-class.png" width=" 90%"></div>
</p>

<p>
("8115",10) の解を表す二分木のオブジェクトを作ってみよう (以下は Scala Worksheet の出力)．<br> 
</p>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">subTree0</span> = Leaf(1)                    
  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; subTree0  : Leaf = Leaf(1)</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">subTree1</span> = Node(<span style="color: #8b2252;">"/"</span>, subTree0, Leaf(5))
  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; subTree1  : Node = Node(/,Leaf(1),Leaf(5))</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">subTree2</span> = Node(<span style="color: #8b2252;">"-"</span>, Leaf(1), subTree1)
  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; subTree2  : Node = Node(-,Leaf(1),Node(/,Leaf(1),Leaf(5)))</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">subTree3</span> = Node(<span style="color: #8b2252;">"/"</span>, Leaf(8), subTree2)
  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; subTree3  : Node = Node(/,Leaf(8),Node(-,Leaf(1),Node(/,Leaf(1),Leaf(5))))</span>
</pre>
</div>
<p>
ここでは生成したオブジェクトを変数 <font color="#a0522d">subTree0</font>， <font color="#a0522d">subTree1</font>， <font color="#a0522d">subTree2</font>， <font color="#a0522d">subTree3</font>に格納している．<br>
これらはオブジェクトを表す変数であり，オブジェクト変数と呼ばれる．
 <div align="center"><img src="./ticket-tree-object.png" width=" 90%"></div>
</p>

<p>
どのように全体の二分木が構成されるかを図示すると次のようになる．
 <div align="center"><img src="./ticket8115-object.png" width=" 90%"></div>
</p>
<p>
もちろんオブジェクト変数にいちいち格納しなくても，いきなり全体のオブジェクトを生成することもできる．
</p>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

Node(<span style="color: #8b2252;">"/"</span>, Leaf(8), Node(<span style="color: #8b2252;">"-"</span>, Leaf(1), Node(<span style="color: #8b2252;">"/"</span>, Leaf(1), Leaf(5))))
    <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res0: Node = Node(/,Leaf(8),Node(-,Leaf(1),Node(/,Leaf(1),Leaf(5))))</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">二分木が与えられた時にその値を計算する</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>ここまでで，Scala で二分木を表すことができた．
</li>
<li>次は二分木が与えられた時にその値を計算する機能を追加する．
</li>
<li>具体的には定義したクラスにDouble型の値を返すメソッド  <font color="#0000ff">value</font> を追加する．
<ul class="org-ul">
<li>クラスにメソッドを記述すると，生成されたオブジェクトでそのメソッドを使えるようになる．
</li>
</ul>
</li>
</ul>
</div>

<div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"> <font color="#0000ff">value</font> メソッド ( <font color="#228b22">Tree</font>クラス)</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>メソッド  <font color="#0000ff">value</font> は内部ノードにも葉ノードにも共通したメソッドであるので <font color="#a020f0">抽象クラス</font> <font color="#228b22">Tree</font>にメソッドの仕様 (メソッド名，引数，戻り値の型) を記述する．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">abstract</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Tree</span> {
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">value</span>: <span style="color: #228b22;">Double</span>
}
</pre>
</div>
<ul class="org-ul">
<li>ここでは引数が無しで戻り値がDouble型のメソッド  <font color="#0000ff">value</font> を定義している．但し，その具体的な処理については書かれていない．
<ul class="org-ul">
<li>抽象クラスではメソッドの中身 (実装) を書かずに仕様だけを定義できる．
</li>
<li>抽象クラス <font color="#228b22">Tree</font>で中身がないメソッドが定義されると，それを継承する <font color="#228b22">Leaf</font>と <font color="#228b22">Node</font>でその中身を書く必要がある.
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"> <font color="#0000ff">value</font> メソッド ( <font color="#228b22">Leaf</font>クラス)</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li> <font color="#228b22">Leaf</font>でメソッド <font color="#0000ff">value</font>の中身を書く (実装する). 
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Leaf</span>(<span style="color: #a0522d;">n</span>: <span style="color: #228b22;">Int</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span> {
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">value</span> = n.toDouble
}
</pre>
</div>
<ul class="org-ul">
<li> <font color="#228b22">Leaf</font>クラスのメソッド <font color="#0000ff">value</font>の実装は簡単．ラベルを表すInt型のnをDouble型に変換するだけで良い．
</li>
<li>= の後に関数の定義の中身 (実装) を記述する．
</li>
<li>なお上記のメソッド定義は波括弧を省略した形である (実装が一行の場合は省略できる)．メソッドの定義が複数行になるときは次のように波括弧で囲む．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Leaf</span>(<span style="color: #a0522d;">n</span>: <span style="color: #228b22;">Int</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span> {
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">value</span> = {
    n.toDouble
  }
}
</pre>
</div>

<ul class="org-ul">
<li>メソッドを定義すると次のように呼び出すことができる．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">subTree0</span> = Leaf(4)                    
subTree0.value                            <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res1: Double = 4.0</span>
Leaf(4).value                             <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res2: Double = 4.0</span>
</pre>
</div>
<ul class="org-ul">
<li>上はオブジェクト変数に格納してから呼ぶ場合．下は直接呼ぶ場合である．
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"> <font color="#0000ff">value</font> メソッド ( <font color="#228b22">Node</font>クラス)</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li> <font color="#228b22">Node</font>でメソッド <font color="#0000ff">value</font>を実装する. 
</li>
</ul>


<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Node</span>(<span style="color: #a0522d;">op</span>: <span style="color: #228b22;">String</span>, <span style="color: #a0522d;">left</span>: <span style="color: #228b22;">Tree</span>, <span style="color: #a0522d;">right</span>: <span style="color: #228b22;">Tree</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span> {
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">value</span> = op <span style="color: #a020f0;">match</span> {
    <span style="color: #a020f0;">case</span> <span style="color: #8b2252;">"+"</span> =&gt; left.value + right.value
    <span style="color: #a020f0;">case</span> <span style="color: #8b2252;">"-"</span> =&gt; ???
    <span style="color: #a020f0;">case</span> <span style="color: #8b2252;">"*"</span> =&gt; ???
    <span style="color: #a020f0;">case</span> <span style="color: #8b2252;">"/"</span> =&gt; ???
  }
}
</pre>
</div>
<ul class="org-ul">
<li> <font color="#228b22">Node</font>クラスでは，ラベルを表す <font color="#228b22">String</font>型の <font color="#a0522d">op</font>によって計算が異なることをメソッド <font color="#0000ff">value</font>に反映させる必要がある．
上記の例では match 式を使って演算子の場合分けをし，それぞれの処理を =&gt; の右側に書いている．
</li>
<li> <font color="#a0522d">left</font> と  <font color="#a0522d">right</font> は <font color="#228b22">Tree</font>型，すなわち <font color="#228b22">Leaf</font>型もしくは <font color="#228b22">Node</font>型である．
<ul class="org-ul">
<li>もし <font color="#a0522d">left</font>が <font color="#228b22">Leaf</font>型であれば <font color="#228b22">Leaf</font>クラスの <font color="#0000ff">value</font>メソッドが自動的に呼ばれる．
</li>
<li>もし <font color="#a0522d">left</font>が <font color="#228b22">Node</font>型であれば <font color="#228b22">Node</font>クラスの <font color="#0000ff">value</font>メソッドが自動的に呼ばれることになる．そしてこれは再帰的に呼び出されることになる．
<ul class="org-ul">
<li>再帰プログラミングのいろいろな応用については <a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/scala-recursive.html">ここ</a> に詳しいので，興味がある人は学習してください．
</li>
</ul>
</li>
<li> <font color="#a0522d">right</font>も同様である．
</li>
</ul>
</li>
<li>例えば(1 + (1 + 5))は以下のように計算される．
</li>
</ul>
<p>
 <div align="center"><img src="./ticket8115-recursive.png" width=" 90%"></div>
</p>

<ul class="org-ul">
<li> <font size="+3">(演習)</font>
<ul class="org-ul">
<li>上記の???を埋めて他の演算 ("-", "*", "/") の場合を実装せよ
</li>
</ul>
</li>
<li> <font size="+3">(テスト)</font> 次のように出力されればOK!
<ul class="org-ul">
<li>自分で他の式も試してみよう!!
</li>
</ul>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

 Node(<span style="color: #8b2252;">"/"</span>, Leaf(8), Node(<span style="color: #8b2252;">"-"</span>, Leaf(1), Node(<span style="color: #8b2252;">"/"</span>, Leaf(1), Leaf(5)))).value
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res11: Double = 10.0</span>
 Node(<span style="color: #8b2252;">"-"</span>, Node(<span style="color: #8b2252;">"*"</span>, Leaf(7), Leaf(5)), Node(<span style="color: #8b2252;">"*"</span>, Leaf(5), Leaf(5))).value
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res12: Double = 10.0</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4"> <font color="#0000ff">valueEquals</font> メソッド</h3>
<div class="outline-text-3" id="text-4-4">
</div><ul class="org-ul"><li>計算誤差を無視するためにメソッド <font color="#0000ff">valueEquals</font>を <font color="#228b22">Tree</font>に実装する．<br  /><div class="outline-text-4" id="text-4-4-1">
<ul class="org-ul">
<li> <font color="#228b22">Leaf</font> でも  <font color="#228b22">Node</font> でも動作は同じなので <font color="#228b22">Tree</font>の中に実装する．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">abstract</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Tree</span> {
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">value</span>: <span style="color: #228b22;">Double</span>
<span style="color: #228b22;">  </span><span style="color: #a020f0;">def</span> valueEquals(x: Double): Boolean = math.abs(x - value) &lt; 1e-5
}
</pre>
</div>
</div>
</li>

<li>式(1 / 3) * (7 / 2)と式(7 / 6) + 1 - 1の値は==を使うとfalseになってしまう．<br  /></li>
<li>誤差を無視するために定義したメソッド <font color="#0000ff">valueEquals</font>を使う．<br  /></li>
<li> <font color="red">(注意)</font> Double型なので11ではなく11.0と記述することに注意．<br  /><div class="outline-text-4" id="text-4-4-4">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">c1</span> = Node(<span style="color: #8b2252;">"*"</span>, Node(<span style="color: #8b2252;">"/"</span>, Leaf(1), Leaf(3)), Node(<span style="color: #8b2252;">"/"</span>, Leaf(7), Leaf(2)))
                                       <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; c1  : Node = ((1 / 3) * (7 / 2))</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">c2</span> = Node(<span style="color: #8b2252;">"-"</span>, Node(<span style="color: #8b2252;">"+"</span>, Node(<span style="color: #8b2252;">"/"</span>, Leaf(7), Leaf(6)), Leaf(1)), Leaf(1))
                                       <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; c2  : Node = (((7 / 6) + 1) - 1)</span>
c1.value == c2.value                             <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res7: Boolean = false</span>
c1.valueEquals(c2.value)                         <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res8: Boolean = true</span>
</pre>
</div>
</div>
</li></ul>
</div>
<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5"> <font color="#0000ff">toString</font> メソッド</h3>
<div class="outline-text-3" id="text-4-5">
</div><ul class="org-ul"><li>現状では <font color="#228b22">Tree</font>型をprintlnしたときの表示が見にくい<br  /></li>
<li>toString はメソッドを上書きすることによって，表示を見やすくする.<br  /><div class="outline-text-4" id="text-4-5-2">
<ul class="org-ul">
<li>toString は暗黙的に既に実装されているので上書き (override) する必要がある．
</li>
</ul>
</div>
</li>

<li>Leaf クラス<br  /><div class="outline-text-4" id="text-4-5-3">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Leaf</span>(<span style="color: #a0522d;">n</span>: <span style="color: #228b22;">Int</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span> {
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">value</span>: <span style="color: #228b22;">Double </span>= n.toDouble
  <span style="color: #a020f0;">override</span> <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">toString</span> = n.toString
}
</pre>
</div>
</div>
</li>
<li>Node クラス<br  /><div class="outline-text-4" id="text-4-5-4">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Node</span>(<span style="color: #a0522d;">op</span>: <span style="color: #228b22;">String</span>, <span style="color: #a0522d;">left</span>: <span style="color: #228b22;">Tree</span>, <span style="color: #a0522d;">right</span>: <span style="color: #228b22;">Tree</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span> {
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">value</span> = ...
  <span style="color: #a020f0;">override</span> <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">toString</span> = 
    <span style="color: #8b2252;">"("</span> + left.toString + <span style="color: #8b2252;">" "</span> + op + <span style="color: #8b2252;">" "</span> + right.toString + <span style="color: #8b2252;">")"</span>
}
</pre>
</div>
</div>
</li>
<li>以下のような出力になる<br  /><div class="outline-text-4" id="text-4-5-5">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

Node(<span style="color: #8b2252;">"/"</span>, Leaf(8), Node(<span style="color: #8b2252;">"-"</span>, Leaf(1), Node(<span style="color: #8b2252;">"/"</span>, Leaf(1), Leaf(5))))
                          <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res0: Node = (8 / (1 - (1 / 5)))</span>
</pre>
</div>
</div>
</li></ul>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">3つの整数の列からの二分木を洩れなく列挙する機能</h2>
<div class="outline-text-2" id="text-5">
<ul class="org-ul">
<li>ここまでで二分木を表現でき，その値を評価できるようになった．
</li>
<li>後は与えられた演算子と整数の列から二分木を洩れなく列挙できればプログラムの完成である．
</li>
<li>4つの整数の列を考える前にまず3つの整数の列からの二分木を洩れなく列挙することを考えてみよう．
</li>
</ul>
</div>
<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">genTrees2, genTrees3  関数の実装</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>なおここから先のプログラムは上記のクラスが書かれた  <font color="#3B5998"><b>TestTree.scala</b></font> ファイル内の  <font color="#a020f0">object</font>  <font color="#228b22">TestTree</font> の波括弧内に書くことする．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">abstract</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Tree</span> = {
...
}
<span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Leaf</span>(<span style="color: #a0522d;">n</span>: <span style="color: #228b22;">Int</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span> = {
...
}
<span style="color: #a020f0;">case</span> <span style="color: #a020f0;">class</span> <span style="color: #228b22;">Node</span>(<span style="color: #a0522d;">op</span>: <span style="color: #228b22;">String</span>, <span style="color: #a0522d;">left</span>: <span style="color: #228b22;">Tree</span>, <span style="color: #a0522d;">right</span>: <span style="color: #228b22;">Tree</span>) <span style="color: #a020f0;">extends</span> <span style="color: #228b22;">Tree</span> = {
...
}

<span style="color: #a020f0;">object</span> <span style="color: #a0522d;">TestTree</span> {

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#12371;&#12371;&#12395;&#20108;&#20998;&#26408;&#12434;&#27945;&#12428;&#12394;&#12367;&#21015;&#25369;&#12377;&#12427;&#38306;&#25968;&#12434;&#26360;&#12356;&#12390;&#12356;&#12367;</span>
  <span style="color: #a020f0;">def</span> <span style="color: #0000ff;">genTrees2</span>(<span style="color: #a0522d;">x1</span>: <span style="color: #228b22;">Int</span>, <span style="color: #a0522d;">x2</span>: <span style="color: #228b22;">Int</span>): <span style="color: #228b22;">Seq[Tree]</span> = {
    ...
  }
<span style="color: #b22222;">// </span><span style="color: #b22222;">&#20197;&#19979;&#21516;&#27096;</span>

}
</pre>
</div>
<ul class="org-ul">
<li>テストは Worksheet から以下のように行えばよい (object week05の波括弧内)．
<ul class="org-ul">
<li>for や foreach の使い方を忘れた人は<a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/scala-list.html"> Scalaでリスト処理</a> で復習しよう
</li>
</ul>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#12486;&#12473;&#12488;&#12398;&#20363; (for &#12434;&#20351;&#12387;&#12383;&#26041;&#27861;)</span>
  <span style="color: #a020f0;">for</span> (tree &lt;- genTrees2(1,2)) println(tree)       <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (1 + 2)</span>
                                                   <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 - 2)</span>
                                                   <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 * 2)</span>
                                                   <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 / 2)</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#12486;&#12473;&#12488;&#12398;&#20363; (foreach &#12434;&#20351;&#12387;&#12383;&#26041;&#27861;)</span>
  genTrees2(1,2).foreach(println)                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (1 + 2)</span>
                                                   <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 - 2)</span>
                                                   <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 * 2)</span>
                                                   <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 / 2)</span>
</pre>
</div>

<ul class="org-ul">
<li>まずは2つの整数の列が与えられた時に洩れなく列挙する関数を考えよう．
</li>
<li> <font color="#3B5998"><b>繰り返しになるが，以下，関数の実装はTestTree.scala内の</b></font>  <font color="#a020f0">object</font>  <font color="#228b22">TestTree</font>  <font color="#3B5998"><b>の波括弧内に書く．</b></font>
<ul class="org-ul">
<li>Worksheet はテスト用!
</li>
</ul>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">genTrees2</span>(<span style="color: #a0522d;">x1</span>: <span style="color: #228b22;">Int</span>, <span style="color: #a0522d;">x2</span>: <span style="color: #228b22;">Int</span>): <span style="color: #228b22;">Seq[Tree]</span> = {
  <span style="color: #a020f0;">for</span> {
    op &lt;- ops
  } <span style="color: #a020f0;">yield</span> Node(op, Leaf(x1), Leaf(x2))
}
</pre>
</div>
<ul class="org-ul">
<li>これは簡単．上記の関数で可能になる．
</li>
<li> <font size="+3">(テスト)</font> Worksheet でテストして以下のように出力されればOK
<ul class="org-ul">
<li>for や foreach の使い方を忘れた人は<a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/scala-list.html"> Scalaでリスト処理</a> で復習しよう
</li>
</ul>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#12486;&#12473;&#12488; (for &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;)</span>
<span style="color: #a020f0;">for</span> (tree &lt;- genTrees2(1,2)) println(tree)       <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (1 + 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 - 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 * 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 / 2)</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#12486;&#12473;&#12488; (foreach &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;)</span>
genTrees2(1,2).foreach(i =&gt; println(i))          <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (1 + 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 - 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 * 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 / 2)</span>
</pre>
</div>
<ul class="org-ul">
<li>次のようにも書ける
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

genTrees2(1,2).foreach(println)                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (1 + 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 - 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 * 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 / 2)</span>
</pre>
</div>
<ul class="org-ul">
<li>1+1, 1-1, 1*1, 1/1 が列挙されていることが分かる. 
</li>
<li>次に3つの整数の列が与えられた時に洩れなく列挙する関数を考えよう．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">genTrees3</span>(<span style="color: #a0522d;">x1</span>: <span style="color: #228b22;">Int</span>, <span style="color: #a0522d;">x2</span>: <span style="color: #228b22;">Int</span>, <span style="color: #a0522d;">x3</span>: <span style="color: #228b22;">Int</span>) = {
  <span style="color: #a020f0;">val</span> <span style="color: #a0522d;">trees1</span> = <span style="color: #a020f0;">for</span> {
    op &lt;- ops
    tree &lt;- genTrees2(x1, x2)
  } <span style="color: #a020f0;">yield</span> Node(op, tree, Leaf(x3.toInt))
  <span style="color: #a020f0;">val</span> <span style="color: #a0522d;">trees2</span> = <span style="color: #a020f0;">for</span> {
    op &lt;- ops
    tree &lt;- genTrees2(x2, x3)
  } <span style="color: #a020f0;">yield</span> Node(op, Leaf(x1.toInt), tree)
  trees1 ++ trees2
}
</pre>
</div>
<ul class="org-ul">
<li>整数の列 x1, x2, x3 が与えられたとすると，これの括弧付けは 
<ul class="org-ul">
<li>(x1 op x2) op x3 もしくは 
</li>
<li>x1 op (x2 op x3) 
</li>
</ul>
<p>
のどちらかになるはず．
</p>
</li>
<li>それらを trees1 と trees2 に入れて trees1 ++ trees2 で連結したものを返せばよい (連結について忘れた人は<a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/scala-list.html"> Scalaでリスト処理</a> を復習しよう．Listについて書かれているがSeqでもどうようにつかえる)．
</li>
<li> <font size="+3">(テスト)</font> Worksheet でテストすると以下のように出力されるはず
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#12486;&#12473;&#12488; (for &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;)</span>
<span style="color: #a020f0;">for</span> (tree &lt;- genTrees3(1,2,3)) println(tree.value + <span style="color: #8b2252;">" "</span> + tree)
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; 6.0 (((1) + (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 2.0 (((1) - (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 5.0 (((1) * (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 3.5 (((1) / (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 0.0 (((1) + (2)) - (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| -4.0 (((1) - (2)) - (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| -1.0 (((1) * (2)) - (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| -2.5 (((1) / (2)) - (3))</span>
                                  <span style="color: #b22222;">// </span><span style="color: #b22222;">... &#30053; ...</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">&#12486;&#12473;&#12488; (foreach &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;)</span>
genTrees3(1,2,3).foreach{i =&gt; println(i.value + <span style="color: #8b2252;">" "</span> + i)}
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; 6.0 (((1) + (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 2.0 (((1) - (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 5.0 (((1) * (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 3.5 (((1) / (2)) + (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| 0.0 (((1) + (2)) - (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| -4.0 (((1) - (2)) - (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| -1.0 (((1) * (2)) - (3))</span>
                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| -2.5 (((1) / (2)) - (3))</span>
                                  <span style="color: #b22222;">// </span><span style="color: #b22222;">... &#30053; ...</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">genTrees3 関数で遊ぶ</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">3つの整数の切符問題を解く (解を列挙) プログラムを考えよう.</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>例えば ("123",6) のにはどのようなものがあるだろうか？
</li>
<li>次のようにして見つけることができる．
<ul class="org-ul">
<li>valueEqualsの引数はDouble型なので6.0として与えることに注意．
</li>
</ul>
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">for &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
<span style="color: #a020f0;">for</span> (tree &lt;- genTrees3(1,2,3) <span style="color: #a020f0;">if</span> tree.valueEquals(6.0)) println(tree)
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (((1) + (2)) + (3))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1) * (2)) * (3))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1) + (2)) + (3))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1) * (2)) * (3))</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">foreach &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
genTrees3(1,2,3).filter(_.valueEquals(6.0)).foreach(i =&gt; println(i))
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (((1) + (2)) + (3))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1) * (2)) * (3))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1) + (2)) + (3))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1) * (2)) * (3))</span>
</pre>
</div>
<ul class="org-ul">
<li>filter などについて忘れた人は<a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/scala-list.html"> Scalaでリスト処理</a> を復習しよう．
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2">3つの整数，かつ，順序可変の切符問題の解を列挙して表示しよう．</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>まず与えられた3つの整数の順列を求めるにはどうすれば良いだろうか?
</li>
<li>permutations 関数を使うと簡単である．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">1, 2, 3 &#12398;&#38918;&#21015;&#12398;&#21015;&#25369; (for &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;)</span>
<span style="color: #a020f0;">for</span> (i &lt;- Seq(1,2,3).permutations) println(i)     <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; List(1, 2, 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(1, 3, 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(2, 1, 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(2, 3, 1)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(3, 1, 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(3, 2, 1)</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">1, 2, 3 &#12398;&#38918;&#21015;&#12398;&#21015;&#25369; (foreach &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;)</span>
Seq(1,2,3).permutations.toList.foreach(println)  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; List(1, 2, 3)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(1, 3, 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(2, 1, 3)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(2, 3, 1)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(3, 1, 2)</span>
                                                 <span style="color: #b22222;">//</span><span style="color: #b22222;">| List(3, 2, 1)</span>
</pre>
</div>
<ul class="org-ul">
<li>この permutations 関数を使えば3つの整数，かつ，順序可変の切符問題の解を求めるプログラムは次のようになる．
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">for &#12434;&#20351;&#12387;&#12383; a &#12398;&#23450;&#32681; (1)</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">a</span> = (<span style="color: #a020f0;">for</span> (xs &lt;- Seq(1,2,3).permutations; tree &lt;- genTrees3(xs(0), xs(1), xs(2))) <span style="color: #a020f0;">yield</span> tree).toList

<span style="color: #b22222;">// </span><span style="color: #b22222;">(&#20986;&#21147;) for &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
<span style="color: #a020f0;">for</span> (i &lt;- a; <span style="color: #a020f0;">if</span> i.valueEquals(6.0)) println(i)
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; ((1 + 2) + 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 2) * 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + 2) + 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 2) * 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + 3) + 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 3) * 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + 3) + 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 3) * 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((2 + 1) + 3)</span>
                                                  <span style="color: #b22222;">// </span><span style="color: #b22222;">... &#30053; ...</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">(&#20986;&#21147;) foreach &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
a.filter(_.valueEquals(6.0)).foreach(i =&gt; println(i))
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; ((1 + 2) + 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 2) * 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + 2) + 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 2) * 3)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + 3) + 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 3) * 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + 3) + 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * 3) * 2)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((2 + 1) + 3)</span>
                                                  <span style="color: #b22222;">// </span><span style="color: #b22222;">... &#30053; ...</span>
</pre>
</div>
<ul class="org-ul">
<li>プログラムが一行で書くには長くなるので，途中の演算結果をaという変数に格納する．ここには"123"の順番を入れ替えた列 (すなわち順列) それぞれに対する二分木を列挙したものが入っている．
</li>
<li>a の定義は次のようにforの丸括弧を波括弧に変えて改行して書くこともできる
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">// </span><span style="color: #b22222;">for &#12434;&#20351;&#12387;&#12383; a &#12398;&#23450;&#32681; (2)</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">a</span> = (<span style="color: #a020f0;">for</span> {
 xs &lt;- Seq(1,2,3).permutations
 tree &lt;- genTrees3(xs(0), xs(1), xs(2))
} <span style="color: #a020f0;">yield</span> tree).toList
</pre>
</div>

<ul class="org-ul">
<li>次に (順序が変わらない) 通常の3整数の切符問題と同様に
<ul class="org-ul">
<li> <font color="#0000ff">for</font>と <font color="#0000ff">if</font>で処理する．もしくは，
</li>
<li> <font color="#0000ff">filter</font>と <font color="#0000ff">foreach</font>で処理する．
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3">たくさんありそうなので size で個数を取得する (32個ある)</h3>
<div class="outline-text-3" id="text-6-3">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

<span style="color: #b22222;">// </span><span style="color: #b22222;">for &#12434;&#20351;&#12387;&#12383; b &#12398;&#23450;&#32681; (1)</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">b</span> = (<span style="color: #a020f0;">for</span> (xs &lt;- Seq(1,2,3).permutations; tree &lt;- genTrees3(xs(0), xs(1), xs(2))) <span style="color: #a020f0;">yield</span> tree).toList

<span style="color: #b22222;">// </span><span style="color: #b22222;">(&#20986;&#21147;) for &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
(<span style="color: #a020f0;">for</span> (i &lt;- b <span style="color: #a020f0;">if</span> i.valueEquals(6.0)) <span style="color: #a020f0;">yield</span> i).size
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res3: Int = 32</span>
<span style="color: #b22222;">// </span><span style="color: #b22222;">(&#20986;&#21147;) foreach &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
b.filter(_.valueEquals(6.0)).size
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res3: Int = 32</span>
</pre>
</div>
<ul class="org-ul">
<li>bの定義は次のようにforの丸括弧を波括弧に変えて改行して書くこともできる
</li>
</ul>
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">// </span><span style="color: #b22222;">for &#12434;&#20351;&#12387;&#12383; b &#12398;&#23450;&#32681; (2)</span>
<span style="color: #a020f0;">val</span> <span style="color: #a0522d;">b</span> = (<span style="color: #a020f0;">for</span> {
  xs &lt;- Seq(1,2,3).permutations
  tree &lt;- genTrees3(xs(0), xs(1), xs(2))
  } <span style="color: #a020f0;">yield</span> tree).toList
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">課題</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">genTrees4 関数</h3>
<div class="outline-text-3" id="text-7-1">
</div><ul class="org-ul"><li>(入力) 整数4つ. Int型の x1, x2, x3, x4<br  /></li>
<li>(出力) 与えられた4つの整数列 (順序固定) から生成できる全てのTreeの列. Seq[Tree]型.<br  /></li>
<li>(実装の条件) genTrees2, genTrees3 を呼び出す<br  /></li>
<li>関数の外枠 (??? を埋めると関数が完成する)<br  /><div class="outline-text-4" id="text-7-1-4">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">genTrees4</span>(<span style="color: #a0522d;">x1</span>: <span style="color: #228b22;">Int</span>, <span style="color: #a0522d;">x2</span>: <span style="color: #228b22;">Int</span>, <span style="color: #a0522d;">x3</span>: <span style="color: #228b22;">Int</span>, <span style="color: #a0522d;">x4</span>: <span style="color: #228b22;">Int</span>): <span style="color: #228b22;">Seq[Tree]</span> = {
  <span style="color: #a020f0;">val</span> <span style="color: #a0522d;">trees1</span> = <span style="color: #a020f0;">for</span> {
    op &lt;- ops
    tree &lt;- genTrees3(x2, x3, x4)
  } <span style="color: #a020f0;">yield</span> Node(op, Leaf(x1), tree)
  <span style="color: #a020f0;">val</span> <span style="color: #a0522d;">trees2</span> = <span style="color: #a020f0;">for</span> {
    op &lt;- ops
    tree &lt;- ???
  } <span style="color: #a020f0;">yield</span> Node(op, tree, Leaf(x4))
  <span style="color: #a020f0;">val</span> <span style="color: #a0522d;">trees3</span> = <span style="color: #a020f0;">for</span> {
    op &lt;- ops
    tree1 &lt;- ???
    tree2 &lt;- ???
  } <span style="color: #a020f0;">yield</span> Node(op, tree1, tree2)
  ??? ++ ??? ++ ???
}
</pre>
</div>
</div>
</li>
<li> <font size="+3">(テスト)</font> 次のようになればひとまずOK (但し，完全なテストではない)<br  /><div class="outline-text-4" id="text-7-1-5">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

  genTrees4(8,1,1,5).size                          <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res8: Int = 320</span>
</pre>
</div>
</div>
</li></ul>
</div>
<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2">findSolutions 関数 &#x2014; 切符問題の解を列挙するプログラム</h3>
<div class="outline-text-3" id="text-7-2">
</div><ul class="org-ul"><li>(入力) Seq[Int]型のxs (長さは4で固定). Int型の a. (すなわち切符問題の入力)<br  /></li>
<li>(出力) 与えられた4つの整数列 (順序固定) から値が a となる全てのTreeの列. Seq[Tree]型.<br  /></li>
<li>(実装の条件) genTrees4 を呼び出す<br  /></li>
<li>関数の外枠 (??? を埋めると関数が完成する)<br  /><div class="outline-text-4" id="text-7-2-4">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">findSolutions</span>(<span style="color: #a0522d;">xs</span>: <span style="color: #228b22;">Seq[Int]</span>, <span style="color: #a0522d;">a</span>: <span style="color: #228b22;">Int</span>): <span style="color: #228b22;">Seq[Tree]</span> = {
  ???
}
</pre>
</div>
</div>
</li>

<li>ヒント<br  /><div class="outline-text-4" id="text-7-2-5">
<ul class="org-ul">
<li>filter と valueEquals を使えば凄く簡単. 「genTrees3で遊ぶ」を参考にしよう．
</li>
</ul>
</div>
</li>

<li> <font size="+3">(テスト)</font> 次のようになればOK<br  /><div class="outline-text-4" id="text-7-2-6">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

 findSolutions(Seq(8,1,1,5), 10)   <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res4: Seq[Tree] = List((8 / (1 - (1 / 5))))</span>
 findSolutions(Seq(7,5,5,5), 10)   <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res5: Seq[Tree] = List(((7 * 5) - (5 * 5)))</span>
</pre>
</div>
<ul class="org-ul">
<li>ここで期待通りの解が得られない場合は genTrees4 の実装が間違っている可能性があるので見直してみよう．
</li>
</ul>
</div>
</li></ul>
</div>
<div id="outline-container-sec-7-3" class="outline-3">
<h3 id="sec-7-3">findAll の実装 &#x2014; 順序可変の切符問題の解を列挙するプログラム</h3>
<div class="outline-text-3" id="text-7-3">
</div><ul class="org-ul"><li>(入力) 整数4つからなる列 Seq[Int]型の xs. 求めたい値 a.<br  /></li>
<li>(出力) 与えられた4つの整数列 (順序の入れ替えを許す) から生成できる全てのTreeの列のうち値がaと一致するもの. Seq[Tree]型.<br  /></li>
<li>(実装の条件) genTrees4 を呼び出す<br  /></li>
<li>関数の外枠 (??? を埋めると関数が完成する. )<br  /><div class="outline-text-4" id="text-7-3-4">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">findAll</span>(<span style="color: #a0522d;">xs</span>: <span style="color: #228b22;">Seq[Int]</span>, <span style="color: #a0522d;">a</span>: <span style="color: #228b22;">Int</span>): <span style="color: #228b22;">Seq[Tree]</span> = {
  <span style="color: #a020f0;">for</span> {
    xs1 &lt;- ???
    tree &lt;- ???
    <span style="color: #a020f0;">if</span> tree.valueEquals(a)
  } <span style="color: #a020f0;">yield</span> tree
 }
</pre>
</div>
</div>
</li>

<li>ヒント<br  /><div class="outline-text-4" id="text-7-3-5">
<ul class="org-ul">
<li>permutations 関数を使えば簡単
</li>
<li>??? のうちどちらかは genTrees4 を呼ぶはず
</li>
</ul>
</div>
</li>

<li> <font size="+3">(テスト)</font> 次のようになればOK<br  /><div class="outline-text-4" id="text-7-3-6">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

 <span style="color: #b22222;">// </span><span style="color: #b22222;">for &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
 <span style="color: #a020f0;">for</span> (i &lt;- findAll(Seq(8,1,1,5),21)) println(i)   <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; ((8 * (1 + 1)) + 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 + 1) * 8) + 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (5 + (8 * (1 + 1)))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (5 + ((1 + 1) * 8))</span>

 <span style="color: #b22222;">// </span><span style="color: #b22222;">foreach &#12434;&#20351;&#12387;&#12383;&#22580;&#21512;</span>
 findAll(Seq(8,1,1,5),21).foreach(println)        <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; ((8 * (1 + 1)) + 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 + 1) * 8) + 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (5 + (8 * (1 + 1)))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (5 + ((1 + 1) * 8))</span>
</pre>
</div>
</div>
</li></ul>
</div>
</div>
<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">チャレンジ課題</h2>
<div class="outline-text-2" id="text-8">
</div><div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1">genTrees 関数</h3>
<div class="outline-text-3" id="text-8-1">
</div><ul class="org-ul"><li>(入力) 整数の列 (順序固定，長さ任意)．Seq[Int]型.<br  /></li>
<li>(出力) 与えられた整数列 (順序固定，長さ任意) から生成できる全てのTreeの列. Seq[Tree]型.<br  /></li>
<li>(実装の条件) 再帰プログラミングを使う．すなわち自分自身 genTrees を呼び出す．<br  /><ul class="org-ul"><li>再帰プログラミングについては <a href="http://bach.istc.kobe-u.ac.jp/lect/ProLang/org/scala-recursive.html">ここ</a> に詳しい．<br  /></li></ul>
</li>

<li>関数の外枠<br  /><div class="outline-text-4" id="text-8-1-4">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #a020f0;">def</span> <span style="color: #0000ff;">genTrees</span>(<span style="color: #a0522d;">xs</span>: <span style="color: #228b22;">Seq[Int]</span>): <span style="color: #228b22;">Seq[Tree]</span> = {
   ???
}
</pre>
</div>
</div>
</li>

<li> <font size="+3">(テスト)</font> 次のようになればOK<br  /><div class="outline-text-4" id="text-8-1-5">
<div class="org-src-container">

<pre class="src src-scala"><span style="color: #b22222;">/**</span>
<span style="color: #b22222;"> * Scala Worksheet (week05.sc)</span>
<span style="color: #b22222;"> */</span>

 genTrees(Seq(1,2,3)).size                        <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res6: Int = 32</span>
 genTrees(Seq(1,2,3,4)).size                      <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res7: Int = 320</span>
 genTrees(Seq(1,2,3,4,5)).size                    <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; res8: Int = 3584</span>
 genTrees(Seq(1,2,3,4,5)).filter(_.valueEquals(10.0)).foreach(println)
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">&gt; (1 + (2 + ((3 * 4) - 5)))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 + ((2 + (3 * 4)) - 5))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 + ((2 * (3 + 4)) - 5))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + 2) + ((3 * 4) - 5))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 + 2) / 3) + (4 + 5))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((((1 + 2) / 3) + 4) + 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 - ((2 - 3) * 4)) + 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((((1 + 2) * 3) - 4) + 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 - (((2 - 3) * 4) - 5))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 - ((2 - 3) * (4 + 5)))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 + 2) * 3) - (4 - 5))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + (2 + (3 * 4))) - 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + (2 * (3 + 4))) - 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 + 2) + (3 * 4)) - 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (1 * (((2 * 3) - 4) * 5))</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + (2 + (3 - 4))) * 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 + ((2 + 3) - 4)) * 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 + 2) + (3 - 4)) * 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 + (2 + 3)) - 4) * 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((((1 + 2) + 3) - 4) * 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| (((1 * (2 * 3)) - 4) * 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((((1 * 2) * 3) - 4) * 5)</span>
                                                  <span style="color: #b22222;">//</span><span style="color: #b22222;">| ((1 * ((2 * 3) - 4)) * 5)</span>
</pre>
</div>
</div>
</li></ul>
</div>
<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2">genDifficult 関数 &#x2014; 難しい切符問題生成関数</h3>
<div class="outline-text-3" id="text-8-2">
</div><ul class="org-ul"><li>(入力) なし<br  /></li>
<li>(出力) 答えが一つしか存在しないような切符問題 (整数4つで順序固定) を全て．Seq[(Seq[Int], Int)]型．<br  /></li></ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Takehide Soh</p>
<p class="date">Created: 2013-11-15 金 14:04</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 23.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.1)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
